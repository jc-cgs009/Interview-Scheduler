{% extends "base.html" %}

{% block title %}Update{% endblock title %}

{% block body %}

<div class="container mt-4">
  <h2>Update Interview</h2>

  <!-- Loading overlay -->
  <div id="loading"
       style="display: none; position: fixed; top: 0; left: 0;
              width: 100%; height: 100%; background: rgba(255,255,255,0.85);
              text-align: center; padding-top: 20%; font-size: 1.5rem;
              color: #333; z-index: 9999;">
    <div class="spinner-border text-primary" role="status"></div><br><br>
    Updating interview, please wait...
  </div>

  <!-- Interview Form -->
  <form method="post" action="/update/{{ interview.sno }}" onsubmit="showLoading()">
    <div class="mb-3">
      <label for="title" class="form-label">Interview Title</label>
      <input type="text" class="form-control" id="title" value="{{ interview.title }}" name="title" required>
    </div>

    {% set guest_list = interview.guests.split(',') %}

    <div class="mb-3">
      <label for="email" class="form-label">Candidate Email</label>
      <input type="email" class="form-control" id="email" value="{{ guest_list[-1] }}" name="email" required>
    </div>

    <div class="mb-3">
      <label for="guests" class="form-label">Guest Emails</label>
      <textarea class="form-control" id="guests" name="guests" rows="3"
                placeholder="Enter multiple guest emails separated by commas or new lines">{{ guest_list[:-1] | join(', ') }}</textarea>
    </div>

    <div class="mb-3">
      <label for="date" class="form-label">Interview Date</label>
      <input type="date" class="form-control" id="date" value="{{ start_date }}" name="date" required>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="start_time" class="form-label">Start Time</label>
        <input type="time" class="form-control" id="start_time" value="{{ start_time }}" name="start_time" required>
      </div>
      <div class="col-md-6 mb-3">
        <label for="end_time" class="form-label">End Time</label>
        <input type="time" class="form-control" id="end_time" value="{{ end_time }}" name="end_time" required>
      </div>
    </div>

    <button type="submit" class="btn btn-primary">Update</button>
  </form>
</div>

<!-- Show loader on form submit -->
<script>
  function showLoading() {
    document.getElementById("loading").style.display = "block";
  }
</script>

{% endblock body %}
